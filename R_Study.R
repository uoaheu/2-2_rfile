# ğŸ“Œ R ê¸°ì´ˆ ë¬¸ë²• ì •ë¦¬
# ì‘ì„±ì: 01HongNa
# ì„¤ëª…: R íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë° ë¡œë”©, ìë£Œí˜•, ìë£Œêµ¬ì¡°, ì¡°ê±´ë¬¸, ë°˜ë³µë¬¸, ì…ì¶œë ¥, íŒ¨í‚¤ì§€ ì‚¬ìš©ë²•

# =======================================
# 1. íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë° ë¡œë”©
# =======================================
install.packages('stringr')
library(stringr)
require(stringr)

# íŒ¨í‚¤ì§€ ì œê±° ì˜ˆì‹œ
remove.packages('stringr')

# =======================================
# 2. ìë£Œí˜• (Data Types)
# =======================================
int <- 20  # ìˆ«ìí˜•
string <- 'í™ê¸¸ë™'  # ë¬¸ìí˜•
boolean <- TRUE  # ë…¼ë¦¬í˜•
a <- NA  # ê²°ì¸¡ì¹˜

cat("ìˆ«ìí˜•:", int, " / ë¬¸ìí˜•:", string, " / ë…¼ë¦¬í˜•:", boolean, "\n")
cat("ë¬´í•œëŒ€:", 100/0, " / NaN:", 0/0, "\n")

# =======================================
# 3. ìë£Œí˜• í™•ì¸ ë° ë³€í™˜
# =======================================
cat("is.numeric:", is.numeric(int), "\n")
cat("is.character:", is.character(string), "\n")
cat("is.logical:", is.logical(boolean), "\n")
cat("is.na:", is.na(a), "\n")

# ìë£Œí˜• ë³€í™˜ ì˜ˆì‹œ
x <- c(1, 2, '3')
cat("as.numeric:", as.numeric(x), "\n")

# =======================================
# 4. ìë£Œêµ¬ì¡° (Data Structures)
# =======================================
# ë²¡í„°
vec <- c(1, 2, 3)
cat("ë²¡í„°:", vec, "\n")

# ë¦¬ìŠ¤íŠ¸
lst <- list(name='í™ê¸¸ë™', age=30)
print(lst)

# ë§¤íŠ¸ë¦­ìŠ¤
mat <- matrix(1:6, nrow=2)
print(mat)

# ë°ì´í„°í”„ë ˆì„
df <- data.frame(id=c(1,2), score=c(90,80))
print(df)

# =======================================
# 5. ë²¡í„° ì—°ì‚° ë° ì²˜ë¦¬ í•¨ìˆ˜
# =======================================
x <- c(1, 3, 5, 7)
y <- c(3, 5)

cat("í•©ì§‘í•©:", union(x, y), "\n")
cat("êµì§‘í•©:", intersect(x, y), "\n")
cat("ì°¨ì§‘í•©:", setdiff(x, y), "\n")

# =======================================
# 6. ì¡°ê±´ë¬¸ê³¼ ë°˜ë³µë¬¸
# =======================================
score <- 85
if (score >= 90) {
  cat("Aí•™ì \n")
} else if (score >= 80) {
  cat("Bí•™ì \n")
} else {
  cat("Cí•™ì \n")
}

for (i in 1:5) {
  cat("ë°˜ë³µ:", i, "\n")
}

# =======================================
# 7. ì‚¬ìš©ì ì •ì˜ í•¨ìˆ˜
# =======================================
f2 <- function(x=10, y=10) {
  cat("x =", x, ", y =", y, "\n")
}
f2(20, 30)

var_sd <- function(x) {
  var <- sum((x - mean(x))^2) / (length(x) - 1)
  sd <- sqrt(var)
  cat("ë¶„ì‚°:", var, ", í‘œì¤€í¸ì°¨:", sd, "\n")
  return(c(var, sd))
}

x <- c(7, 5, 12, 9, 15, 6)
result <- var_sd(x)

# =======================================
# 8. ë°ì´í„° ì…ì¶œë ¥ (Input/Output)
# =======================================
write.csv(df, "data/output.csv", row.names=F)
df_in <- read.csv("data/output.csv")
cat("\nğŸ“Œ CSV ì½ê¸° ê²°ê³¼:\n")
print(df_in)

# =======================================
# 9. ë¬¸ìì—´ ì²˜ë¦¬ (stringr íŒ¨í‚¤ì§€)
# =======================================
string <- "hongkildong105lee1002you25ê°•ê°ì°¬2005"
cat("ë¬¸ìì—´ ê¸¸ì´:", str_length(string), "\n")
cat("íŠ¹ì • ìœ„ì¹˜:", str_sub(string, 26, 28), "\n")
cat("ëŒ€ë¬¸ì ë³€í™˜:", str_to_upper(string), "\n")

# ì •ê·œ í‘œí˜„ì‹ í™œìš©
jumin <- '991212-1234583'
cat("ì •ê·œí‘œí˜„ì‹ ê²°ê³¼:", str_extract_all(jumin, '\\d{6}-[1-4]\\d{6}'), "\n")

# =======================================
# 10. ìˆ˜í•™ ê´€ë ¨ ë‚´ì¥ í•¨ìˆ˜
# =======================================
cat("ë°˜ì˜¬ë¦¼:", round(23.54), "\n")
cat("ëˆ„ì í•©:", cumsum(1:4), "\n")
cat("ëˆ„ì ê³±:", cumprod(1:4), "\n")

# =======================================
# 11. ë‚œìˆ˜ ìƒì„± ë° í™•ë¥  ë¶„í¬
# =======================================
set.seed(123)
n <- 20
r <- rbinom(n, 1, prob=0.5)
cat("ì´í•­ë¶„í¬ ë‚œìˆ˜ ìƒì„±:", r, "\n")

# =======================================
# 12. ë°ì´í„° ë³‘í•©
# =======================================
height <- data.frame(id=c(1, 2, 3), h=c(180, 175, 155))
weight <- data.frame(id=c(1, 2), w=c(80, 75))
user <- merge(height, weight, by="id", all=T)
print(user)

# =======================================
# 13. ëª¬í…Œì¹´ë¥¼ë¡œ ì‹œë®¬ë ˆì´ì…˜
# =======================================
coin <- function(n) {
  r <- runif(n, 0, 1)
  return(ifelse(r <= 0.5, 0, 1))
}

montaCoin <- function(n) {
  cnt <- 0
  for (i in 1:n) {
    cnt <- cnt + coin(1)
  }
  res <- cnt / n
  return(res)
}

cat("ëª¬í…Œì¹´ë¥¼ë¡œ ì‹œë®¬ë ˆì´ì…˜:", montaCoin(10000), "\n")

# =======================================
# 14. ë§ˆë¬´ë¦¬
# =======================================
cat("\nR ê¸°ì´ˆ ë¬¸ë²• ì •ë¦¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\n")
